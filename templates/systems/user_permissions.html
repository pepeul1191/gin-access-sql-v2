{{define "users/roles-permissions"}}
  {{template "dashboard_header.html" .}}

  <div class="container-fluid py-4">
    <h3 class="mb-4">
      <a class="return-nav" href="/systems"><i class="fa fa-cogs me-2"></i>Gestión de Sistemas</a>
      / <a class="return-nav" href="/systems/{{.systemID}}/users">Editar Sistema</a> / Asociar Permisos
    </h3>

    {{if .message.Type}}
    <div class="alert alert-{{.message.Type}}">
        {{.message.Content}}
    </div>
    {{end}}

    <!-- Roles and Permissions Section -->
    <div class="row">
      {{range .permissions}} <!-- Itera sobre los permisos -->
        <div class="col-md-12 mb-4">
          <!-- Card for each role -->
          <div class="card">
            <div class="card-header">
              <h6 class="mb-0">
                <i class="fa fa-list me-2"></i>
                Rol {{.Name}} <!-- Nombre del rol -->
              </h6>
            </div>
            <div class="card-body" style="padding-top: 0px;">
              <form method="POST" action="/systems/{{$.systemID}}/users/{{$.userID}}/permissions">
                <input type="hidden" name="_csrf" value="{{$.csrfToken}}">
                <div class="row d-flex justify-content-between align-items-center">
                  <div class="col-md-8">
                    <!-- El texto a la izquierda -->
                    <p class="mb-0">Lista de permisos del rol asignados al usuario</p>
                  </div>
                  
                  <div class="col-md-4 text-end">
                    <!-- Botón empujado a la derecha -->
                    <button type="submit" class="btn btn-primary mt-3">Asociar Permisos</button>
                  </div>
                </div>
                <div class="row">
                  {{range .Permissions}} <!-- Itera sobre los permisos del rol -->
                    <div class="col-md-2 mb-2">
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="permissions[{{.ID}}]" 
                               value="1" {{if .IsAssigned}}checked{{end}}>
                        <label class="form-check-label" for="permission-{{.ID}}">
                          {{.Name}} <!-- Nombre del permiso -->
                        </label>
                      </div>
                    </div>
                  {{end}}
                </div>
              </form>
            </div>
          </div>
        </div>
      {{end}}
    </div>

  </div>

  {{template "dashboard_footer.html" .}}
{{end}}
